<!--begin::Modal content-->
<div class="modal-content">
  <!--begin::Modal header-->
  <div class="modal-header" id="kt_modal_add_user_header">
    <h5 class="modal-title">Agregar Documento  Módulo #{{ idModulo }}</h5>
    <div class="btn btn-sm btn-icon btn-active-color-primary" (click)="close()" style="cursor:pointer">
      <i class="fas fa-times"></i>
    </div>
  </div>
  <!--end::Modal header-->

  <!--begin::Modal body-->
  <div class="modal-body py-10 px-lg-17">
    <form class="form">
      <div class="row g-5">
         <!-- Columna 1 -->
      <div class="col-md-6">
        <!-- Botón Agregar -->
        <div class="mb-3">
          <button type="button" class="btn btn-sm btn-secondary" (click)="agregarCampo()">Agregar Parámetros</button>
        </div>

        <!-- Campos dinámicos -->
        <div *ngFor="let campo of campos; let i = index" class="mb-2 d-flex align-items-center gap-2">
          <!-- Título del campo -->
          <input
            type="text"
            class="form-control"
            [(ngModel)]="campo.titulo"
            [name]="'titulo_' + i"
            placeholder="Ej: Nombre, Apellido, Título"
            style="width: 40%;"
          />

          <!-- Valor del campo (editable) -->
          <input
            type="text"
            class="form-control"
            [(ngModel)]="campo.valor"
            [name]="'valor_' + i"
            [readonly]="inputSeleccionadoIndex !== i"
            (click)="seleccionarInput(i)"
            placeholder="Ingrese valor o seleccione del PDF"
            style="width: 50%;"
          />

          <!-- Botón eliminar -->
          <button
            type="button"
            class="btn btn-icon btn-sm btn-danger"
            (click)="eliminarCampo(i)"
            title="Eliminar campo"
          >
            <i class="fas fa-trash-alt"></i>
          </button>
        </div>
      </div>

      <!-- Columna 2 -->
<!-- Columna 2 -->
<div class="col-md-6">
  <div class="fv-row mb-5">
    <label class="form-label">Subir documentos (solo PDF)</label>
    <input
      type="file"
      class="form-control"
      (change)="onFileSelectedtemp($event)"
      accept=".pdf"
    />
  </div>

  <div class="mt-3">
    <button class="btn btn-primary" (click)="hacerOCR()">Deseo hacer OCR</button>
  </div>

<!-- VISOR DE IMÁGENES -->
<div class="mt-3" *ngIf="imagenesPDF.length > 0">
  <h5>Visor de páginas del PDF</h5>

  <div *ngFor="let img of imagenesPDF; let i = index" style="margin-bottom: 1rem;">
    <p>Página {{ i + 1 }}</p>

    <canvas
      #canvas
      width="600"
      height="800"
      style="border:1px solid #ccc;"
      (mousedown)="onMouseDown($event, i)"
      (mousemove)="onMouseMove($event, i)"
      (mouseup)="onMouseUp($event, i)"
    ></canvas>

    <!-- aquí mostramos la parte seleccionada -->
    <div *ngIf="recorte && selectedPage === i" style="margin-top: 10px;">
      <p>Fragmento seleccionado:</p>
      <img [src]="recorte" style="border:1px solid green; max-width:200px;" />
    </div>
  </div>
</div>



</div>



  </div>

      <!-- Botones -->
      <div class="text-end pt-10">
        <button type="button" class="btn btn-light me-3" (click)="close()">Cancelar</button>
        <button type="button" class="btn btn-primary" (click)="guardar()">
          <span class="indicator-label">Guardar</span>
        </button>
      </div>
    </form>
  </div>
  <!--end::Modal body-->
</div>
<!--end::Modal content-->
