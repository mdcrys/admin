"use strict";(self.webpackChunkdemo1=self.webpackChunkdemo1||[]).push([[433],{4102:(x,p,c)=>{c.r(p),c.d(p,{SeccionesModule:()=>F});var u=c(6814),m=c(7304),h=c(3462),e=c(5879),d=c(1274),g=c(2425),_=c(9142),a=c(6223);function Z(n,l){if(1&n&&(e.TgZ(0,"option",24),e._uU(1),e.qZA()),2&n){const t=l.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.nombre)}}function b(n,l){if(1&n&&(e.TgZ(0,"option",24),e._uU(1),e.qZA()),2&n){const t=l.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.nombre)}}function v(n,l){if(1&n&&(e.TgZ(0,"li",28),e._uU(1),e.qZA()),2&n){const t=l.$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function T(n,l){if(1&n&&(e.TgZ(0,"div",25)(1,"label",10),e._uU(2,"Archivos seleccionados:"),e.qZA(),e.TgZ(3,"ul",26),e.YNc(4,v,2,1,"li",27),e.qZA()()),2&n){const t=e.oxw();e.xp6(4),e.Q6J("ngForOf",t.archivosSeleccionados)}}let C=(()=>{class n{activeModal;toast;seccionesService;idSeccion;idModulo;DocumentoCreado=new e.vpe;tipologia="";tema="";id_estanteria=null;id_caja=null;fecha="";archivosSeleccionados=[];estanterias=[{id:1,nombre:"Estanter\xeda A"},{id:2,nombre:"Estanter\xeda B"},{id:3,nombre:"Estanter\xeda C"}];cajas=[{id:1,nombre:"Caja 1"},{id:2,nombre:"Caja 2"},{id:3,nombre:"Caja 3"}];constructor(t,i,o){this.activeModal=t,this.toast=i,this.seccionesService=o}close(){this.activeModal.close()}onFileSelected(t){t.target.files&&t.target.files.length>0&&(this.archivosSeleccionados=Array.from(t.target.files),console.log("Archivos seleccionados:",this.archivosSeleccionados))}store(){if(!(this.tipologia&&this.tema&&this.id_estanteria&&this.id_caja))return void this.toast.error("Todos los campos son obligatorios","Validaci\xf3n");if(0===this.archivosSeleccionados.length)return void this.toast.error("Debes seleccionar al menos un documento","Validaci\xf3n");const t=new FormData;t.append("tipologia",this.tipologia),t.append("tema",this.tema),t.append("id_estanteria",this.id_estanteria.toString()),t.append("id_caja",this.id_caja.toString()),t.append("id_seccion",this.idSeccion.toString()),t.append("id_modulo",this.idModulo.toString()),this.fecha&&t.append("fecha",this.fecha),this.archivosSeleccionados.forEach(i=>{t.append("archivos[]",i)}),this.seccionesService.registrarDocumento(t).subscribe({next:i=>{i.errores&&i.errores.length>0&&i.errores.forEach(o=>{this.toast.error(o,"OCR no aplicado")}),this.toast.success("Documento registrado correctamente","\xc9xito"),this.DocumentoCreado.emit(i.documento||i),this.activeModal.close()},error:i=>{console.error("Error al registrar documento",i),this.toast.error("Error al registrar documento","Error")}})}static \u0275fac=function(i){return new(i||n)(e.Y36(d.Kz),e.Y36(g._W),e.Y36(_.k))};static \u0275cmp=e.Xpm({type:n,selectors:[["app-create-documento-sessiones"]],inputs:{idSeccion:"idSeccion",idModulo:"idModulo"},outputs:{DocumentoCreado:"DocumentoCreado"},decls:48,vars:10,consts:[[1,"modal-content"],["id","kt_modal_add_user_header",1,"modal-header"],[1,"modal-title"],[1,"btn","btn-sm","btn-icon","btn-active-color-primary",2,"cursor","pointer",3,"click"],[1,"fas","fa-times"],[1,"modal-body","py-10","px-lg-17"],[1,"form",3,"ngSubmit"],[1,"row","g-5"],[1,"col-md-6"],[1,"fv-row","mb-5"],[1,"form-label"],["type","text","name","tipologia","required","",1,"form-control",3,"ngModel","ngModelChange"],["type","text","name","tema","required","",1,"form-control",3,"ngModel","ngModelChange"],["name","estanteria","required","",1,"form-select",3,"ngModel","ngModelChange"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],["name","caja","required","",1,"form-select",3,"ngModel","ngModelChange"],["type","date","name","fecha",1,"form-control",3,"ngModel","ngModelChange"],["type","file","multiple","","accept",".pdf,.doc,.docx,.jpg,.jpeg,.png",1,"form-control",3,"change"],["class","mt-2",4,"ngIf"],[1,"text-end","pt-10"],["type","button",1,"btn","btn-light","me-3",3,"click"],["type","submit",1,"btn","btn-primary"],[1,"indicator-label"],[3,"value"],[1,"mt-2"],[1,"list-group"],["class","list-group-item py-1 px-2 d-flex align-items-center justify-content-between",4,"ngFor","ngForOf"],[1,"list-group-item","py-1","px-2","d-flex","align-items-center","justify-content-between"]],template:function(i,o){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h5",2),e._uU(3),e.qZA(),e.TgZ(4,"div",3),e.NdJ("click",function(){return o.close()}),e._UZ(5,"i",4),e.qZA()(),e.TgZ(6,"div",5)(7,"form",6),e.NdJ("ngSubmit",function(){return o.store()}),e.TgZ(8,"div",7)(9,"div",8)(10,"div",9)(11,"label",10),e._uU(12,"Tipolog\xeda"),e.qZA(),e.TgZ(13,"input",11),e.NdJ("ngModelChange",function(r){return o.tipologia=r}),e.qZA()(),e.TgZ(14,"div",9)(15,"label",10),e._uU(16,"Tema"),e.qZA(),e.TgZ(17,"input",12),e.NdJ("ngModelChange",function(r){return o.tema=r}),e.qZA()(),e.TgZ(18,"div",9)(19,"label",10),e._uU(20,"Estanter\xeda"),e.qZA(),e.TgZ(21,"select",13),e.NdJ("ngModelChange",function(r){return o.id_estanteria=r}),e.TgZ(22,"option",14),e._uU(23,"Seleccione estanter\xeda"),e.qZA(),e.YNc(24,Z,2,2,"option",15),e.qZA()(),e.TgZ(25,"div",9)(26,"label",10),e._uU(27,"Caja"),e.qZA(),e.TgZ(28,"select",16),e.NdJ("ngModelChange",function(r){return o.id_caja=r}),e.TgZ(29,"option",14),e._uU(30,"Seleccione caja"),e.qZA(),e.YNc(31,b,2,2,"option",15),e.qZA()(),e.TgZ(32,"div",9)(33,"label",10),e._uU(34,"Fecha del Documento"),e.qZA(),e.TgZ(35,"input",17),e.NdJ("ngModelChange",function(r){return o.fecha=r}),e.qZA()()(),e.TgZ(36,"div",8)(37,"div",9)(38,"label",10),e._uU(39,"Subir documentos"),e.qZA(),e.TgZ(40,"input",18),e.NdJ("change",function(r){return o.onFileSelected(r)}),e.qZA()(),e.YNc(41,T,5,1,"div",19),e.qZA()(),e.TgZ(42,"div",20)(43,"button",21),e.NdJ("click",function(){return o.close()}),e._uU(44,"Cancelar"),e.qZA(),e.TgZ(45,"button",22)(46,"span",23),e._uU(47,"Guardar"),e.qZA()()()()()()),2&i&&(e.xp6(3),e.AsE("Agregar Documento - Secci\xf3n #",o.idSeccion,", M\xf3dulo #",o.idModulo,""),e.xp6(10),e.Q6J("ngModel",o.tipologia),e.xp6(4),e.Q6J("ngModel",o.tema),e.xp6(4),e.Q6J("ngModel",o.id_estanteria),e.xp6(3),e.Q6J("ngForOf",o.estanterias),e.xp6(4),e.Q6J("ngModel",o.id_caja),e.xp6(3),e.Q6J("ngForOf",o.cajas),e.xp6(4),e.Q6J("ngModel",o.fecha),e.xp6(6),e.Q6J("ngIf",o.archivosSeleccionados.length>0))},dependencies:[u.sg,u.O5,a._Y,a.YN,a.Kr,a.Fj,a.EJ,a.JJ,a.JL,a.Q7,a.On,a.F]})}return n})();var S=c(553);function A(n,l){if(1&n&&(e.TgZ(0,"a",14),e._UZ(1,"i",15),e._uU(2," Clic "),e.qZA()),2&n){const t=e.oxw();e.Q6J("href",t.URL_BACKEND+"storage/"+t.documento.archivo_url,e.LSH)}}function q(n,l){1&n&&(e.TgZ(0,"p",16),e._uU(1,"No se ha proporcionado un enlace."),e.qZA())}let D=(()=>{class n{activeModal;documento;URL_BACKEND=S.N.URL_BACKEND;constructor(t){this.activeModal=t}ngOnInit(){console.log("\u{1f4e6} Documento recibido en el modal:",this.documento)}static \u0275fac=function(i){return new(i||n)(e.Y36(d.Kz))};static \u0275cmp=e.Xpm({type:n,selectors:[["app-ver-documento-sessiones"]],inputs:{documento:"documento"},decls:37,vars:8,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"row"],[1,"col-md-6"],[1,"fv-row","mb-4"],[1,"form-label"],["type","text","disabled","",1,"form-control",3,"value"],["type","date","disabled","",1,"form-control",3,"value"],["target","_blank","class","btn btn-outline-primary",3,"href",4,"ngIf"],["class","text-muted",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["target","_blank",1,"btn","btn-outline-primary",3,"href"],[1,"fas","fa-mouse-pointer","me-2"],[1,"text-muted"]],template:function(i,o){1&i&&(e.TgZ(0,"div",0)(1,"h5",1),e._uU(2),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return o.activeModal.dismiss()}),e.qZA()(),e.TgZ(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",6)(8,"label",7),e._uU(9,"Tipolog\xeda"),e.qZA(),e._UZ(10,"input",8),e.qZA(),e.TgZ(11,"div",6)(12,"label",7),e._uU(13,"Tema"),e.qZA(),e._UZ(14,"input",8),e.qZA(),e.TgZ(15,"div",6)(16,"label",7),e._uU(17,"Estanter\xeda"),e.qZA(),e._UZ(18,"input",8),e.qZA(),e.TgZ(19,"div",6)(20,"label",7),e._uU(21,"Caja"),e.qZA(),e._UZ(22,"input",8),e.qZA(),e.TgZ(23,"div",6)(24,"label",7),e._uU(25,"Fecha del Documento"),e.qZA(),e._UZ(26,"input",9),e.qZA()(),e.TgZ(27,"div",5)(28,"div",6)(29,"label",7),e._uU(30,"Hiperv\xednculo"),e.qZA(),e._UZ(31,"br"),e.YNc(32,A,3,1,"a",10),e.YNc(33,q,2,0,"p",11),e.qZA()()()(),e.TgZ(34,"div",12)(35,"button",13),e.NdJ("click",function(){return o.activeModal.close()}),e._uU(36,"Cerrar"),e.qZA()()),2&i&&(e.xp6(2),e.hij("Ver Documento: ",null==o.documento?null:o.documento.tipologia,""),e.xp6(8),e.Q6J("value",null==o.documento?null:o.documento.tipologia),e.xp6(4),e.Q6J("value",null==o.documento?null:o.documento.tema),e.xp6(4),e.Q6J("value",(null==o.documento?null:o.documento.estanteria_nombre)||(null==o.documento?null:o.documento.id_estanteria)),e.xp6(4),e.Q6J("value",(null==o.documento?null:o.documento.caja_nombre)||(null==o.documento?null:o.documento.id_caja)),e.xp6(4),e.Q6J("value",null==o.documento?null:o.documento.fecha),e.xp6(6),e.Q6J("ngIf",null==o.documento?null:o.documento.archivo_url),e.xp6(1),e.Q6J("ngIf",!(null!=o.documento&&o.documento.archivo_url)))},dependencies:[u.O5]})}return n})();function U(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td")(10,"button",33),e.NdJ("click",function(){const s=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.verDocumento(s))}),e._UZ(11,"i",34),e.qZA()()()}if(2&n){const t=l.$implicit;e.xp6(2),e.Oqu(t.tipologia),e.xp6(2),e.Oqu(t.tema),e.xp6(2),e.Oqu(t.id_estanteria),e.xp6(2),e.Oqu(t.id_caja)}}function M(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"div",23)(1,"table",24)(2,"thead",25)(3,"tr")(4,"th"),e._uU(5,"Tipolog\xeda"),e.qZA(),e.TgZ(6,"th"),e._uU(7,"Tema"),e.qZA(),e.TgZ(8,"th"),e._uU(9,"Estanter\xeda"),e.qZA(),e.TgZ(10,"th"),e._uU(11,"Caja"),e.qZA(),e.TgZ(12,"th"),e._uU(13,"Acciones"),e.qZA()()(),e.TgZ(14,"tbody"),e.YNc(15,U,12,4,"tr",26),e.qZA()(),e.TgZ(16,"nav",27)(17,"ul",28)(18,"li",29)(19,"a",30),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.cambiarPagina(o.currentPage-1))}),e._uU(20,"Anterior"),e.qZA()(),e.TgZ(21,"li",31)(22,"span",32),e._uU(23),e.qZA()(),e.TgZ(24,"li",29)(25,"a",30),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.cambiarPagina(o.currentPage+1))}),e._uU(26,"Siguiente"),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(15),e.Q6J("ngForOf",t.documentosPaginados.data),e.xp6(3),e.ekj("disabled",1===t.currentPage),e.xp6(5),e.AsE("P\xe1gina ",t.currentPage," de ",t.totalPages,""),e.xp6(1),e.ekj("disabled",t.currentPage===t.totalPages)}}function J(n,l){1&n&&(e.TgZ(0,"div",35),e._uU(1," No se encontraron documentos.\n"),e.qZA())}let f=(()=>{class n{route;modalService;documentoService;fb;cdr;toastr;idSeccion;idModulo;documentosPaginados=null;busquedaEjecutada=!1;formularioBusqueda;documentos=[];currentPage=1;totalPages=1;constructor(t,i,o,s,r,k){this.route=t,this.modalService=i,this.documentoService=o,this.fb=s,this.cdr=r,this.toastr=k}ngOnInit(){this.idSeccion=+this.route.snapshot.paramMap.get("idSeccion"),this.idModulo=+this.route.snapshot.paramMap.get("idModulo"),this.formularioBusqueda=this.fb.group({tipologia:[""],tema:[""],estanteria:[""],caja:[""]})}agregarDocumento(){const t=this.modalService.open(C,{centered:!0,size:"xl"});t.componentInstance.idSeccion=this.idSeccion,t.componentInstance.idModulo=this.idModulo,t.componentInstance.DocumentoCreado.subscribe(i=>{console.log("Documento creado:",i),this.buscar(),t.close()})}buscar(t=1){const i=this.formularioBusqueda.value;i.id_seccion=this.idSeccion,this.documentoService.listDocumentos(t,i).subscribe(o=>{this.documentosPaginados=o.documentos,this.currentPage=o.documentos.current_page,this.totalPages=o.documentos.last_page,this.busquedaEjecutada=!0,this.cdr.detectChanges(),this.documentosPaginados.data.length>0?this.toastr.success("Se encontraron documentos","\xc9xito"):this.toastr.info("No se encontraron documentos","Informaci\xf3n")},o=>{this.toastr.error("Error al obtener documentos","Error")})}cambiarPagina(t){t>0&&t<=this.totalPages&&this.buscar(t)}tieneFiltros(){return Object.values(this.formularioBusqueda.value).some(i=>""!==String(i).trim())}verDocumento(t){console.log("Documento que se env\xeda al modal:",t);const i=this.modalService.open(D,{centered:!0,size:"xl"});i.componentInstance.documento=t,i.result.then(o=>{console.log("Modal cerrado con resultado:",o)}).catch(o=>{})}static \u0275fac=function(i){return new(i||n)(e.Y36(m.gz),e.Y36(d.FF),e.Y36(_.k),e.Y36(a.qu),e.Y36(e.sBO),e.Y36(g._W))};static \u0275cmp=e.Xpm({type:n,selectors:[["app-detalle-sessiones"]],decls:39,vars:3,consts:[[1,"card"],[1,"card-header"],[1,"card-title"],[1,"card-body","pt-0"],["type","button",1,"btn","btn-sm","btn-success",3,"click"],[1,"fas","fa-plus","me-2"],[1,"card-body"],[3,"formGroup","ngSubmit"],[1,"row","mb-3"],[1,"col-md-3"],["for","tipologia"],["type","text","id","tipologia","formControlName","tipologia","placeholder","Ingrese tipolog\xeda",1,"form-control"],["for","tema"],["type","text","id","tema","formControlName","tema","placeholder","Ingrese tema",1,"form-control"],["for","estanteria"],["type","text","id","estanteria","formControlName","estanteria","placeholder","Ingrese estanter\xeda",1,"form-control"],["for","caja"],["type","text","id","caja","formControlName","caja","placeholder","Ingrese caja",1,"form-control"],[1,"text-center"],["type","submit",1,"btn","btn-primary"],[1,"bi","bi-search"],["class","table-responsive mt-3",4,"ngIf"],["class","alert alert-warning mt-3",4,"ngIf"],[1,"table-responsive","mt-3"],[1,"table","table-bordered","table-striped"],[1,"table-dark"],[4,"ngFor","ngForOf"],[1,"mt-3"],[1,"pagination","justify-content-center"],[1,"page-item"],[1,"page-link",3,"click"],[1,"page-item","disabled"],[1,"page-link"],["title","Ver documento",1,"btn","btn-sm","btn-primary",3,"click"],[1,"fas","fa-eye"],[1,"alert","alert-warning","mt-3"]],template:function(i,o){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h3",2),e._uU(3,"Secci\xf3n Detalle"),e.qZA()(),e.TgZ(4,"div",3)(5,"button",4),e.NdJ("click",function(){return o.agregarDocumento()}),e._UZ(6,"i",5),e._uU(7," Agregar Documento "),e.qZA(),e._UZ(8,"hr"),e.TgZ(9,"div",0)(10,"div",1)(11,"h3",2),e._uU(12,"Formulario de B\xfasqueda"),e.qZA()(),e.TgZ(13,"div",6)(14,"form",7),e.NdJ("ngSubmit",function(){return o.buscar()}),e.TgZ(15,"div",8)(16,"div",9)(17,"label",10),e._uU(18,"Tipolog\xeda"),e.qZA(),e._UZ(19,"input",11),e.qZA(),e.TgZ(20,"div",9)(21,"label",12),e._uU(22,"Tema"),e.qZA(),e._UZ(23,"input",13),e.qZA(),e.TgZ(24,"div",9)(25,"label",14),e._uU(26,"Estanter\xeda"),e.qZA(),e._UZ(27,"input",15),e.qZA(),e.TgZ(28,"div",9)(29,"label",16),e._uU(30,"Caja"),e.qZA(),e._UZ(31,"input",17),e.qZA()(),e.TgZ(32,"div",18)(33,"button",19),e._UZ(34,"i",20),e._uU(35," Obtener Reporte "),e.qZA()()(),e._UZ(36,"hr"),e.YNc(37,M,27,7,"div",21),e.YNc(38,J,2,0,"div",22),e.qZA()()()()),2&i&&(e.xp6(14),e.Q6J("formGroup",o.formularioBusqueda),e.xp6(23),e.Q6J("ngIf",o.busquedaEjecutada&&o.documentosPaginados&&o.documentosPaginados.data.length>0),e.xp6(1),e.Q6J("ngIf",o.busquedaEjecutada&&o.documentosPaginados&&0===o.documentosPaginados.data.length&&1===o.currentPage))},dependencies:[u.sg,u.O5,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u]})}return n})();const y=[{path:"seccion/:idSeccion/modulo/:idModulo",component:f},{path:"modulo/:id",component:h.u},{path:"seccion/:id",component:f},{path:"",redirectTo:"modulo/1",pathMatch:"full"}];let j=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=e.oAB({type:n});static \u0275inj=e.cJS({imports:[m.Bz.forChild(y),m.Bz]})}return n})();var E=c(9862),N=c(53);let F=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=e.oAB({type:n});static \u0275inj=e.cJS({imports:[u.ez,j,E.JF,a.u5,d.IJ,a.UX,N.vi,d.bz,d.jF]})}return n})()}}]);